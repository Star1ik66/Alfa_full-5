üß© CSV Merger with Polars

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ CSV-—Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–∏–Ω, –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ —É —Ñ–∞–π–ª–æ–≤ —Ä–∞–∑–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö.
–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Polars
 ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã pandas.

üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö CSV-—Ñ–∞–π–ª–æ–≤.

üß† –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∫ —Å—Ç—Ä–æ–∫–∞–º.

üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ ¬´–≤ —Å—Ç–æ–ª–±–µ—Ü¬ª (—Å—Ç—Ä–æ–∫–∏ –∏–¥—É—Ç –ø–æ–¥—Ä—è–¥).

üß± –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å—Ö–µ–º (how="vertical_relaxed").

üßæ –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã (–∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã, —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∏ —Ç.–¥.).

üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
pip install polars

üß© –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ–º–µ—Å—Ç–∏ –Ω—É–∂–Ω—ã–µ CSV-—Ñ–∞–π–ª—ã –≤ —Ç—É –∂–µ –ø–∞–ø–∫—É, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç.

–£–∫–∞–∂–∏ –∏—Ö –∏–º–µ–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ files –≤ –∫–æ–¥–µ:

files = [
    "mocsov_contacts.csv",
    "mocsov5_contacts.csv",
]


–ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:

python merge_csvs.py


–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

‚úÖ –ì–æ—Ç–æ–≤–æ! –û–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Ñ–∞–π–ª–æ–≤, –∏—Ç–æ–≥: 105238 —Å—Ç—Ä–æ–∫.
–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤: /path/to/moscov_merged.csv

üìÇ –†–µ–∑—É–ª—å—Ç–∞—Ç

–§–∞–π–ª moscov_merged.csv –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É append (–æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º).

name	phone	email
–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤	+79991234567	ivan@mail.ru

–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞	+79161234567	anna@example.com

...	...	...
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ª–æ–≥–∏–∫–∞

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–±–æ—á—É—é –ø–∞–ø–∫—É (os.getcwd()).

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ignore_errors=True, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.

infer_schema_length=10000 —É—Å–∫–æ—Ä—è–µ—Ç —á—Ç–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.

–í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ç–∏–ø—É (Utf8), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏.

–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–µ–¥–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É.

üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ.
